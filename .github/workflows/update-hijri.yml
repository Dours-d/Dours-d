- name: Rebuild README
        shell: python
        run: |
          import urllib.request
          import json
          import sys

          # 1. Get the Date
          try:
              with urllib.request.urlopen("http://api.aladhan.com/v1/gToH") as response:
                  data = json.loads(response.read().decode())
                  h = data['data']['hijri']
                  
                  # Formatting with Ligatures: ï·½ at the top and ï·º after the month
                  # Use <h3> for better visibility on the profile
                  date_str = (
                      "### ï·½\n"
                      f"### ðŸŒ™ {h['day']} {h['month']['en']} {h['year']} | {h['month']['ar']} ï·º"
                  )
          except Exception as e:
              print(f"API Error: {e}")
              sys.exit(1)

          # 2. Markers (Must match exactly what is in your README.md)
          start_tag = "[//]: # (HIJRI_START)"
          end_tag = "[//]: # (HIJRI_END)"

          # 3. Read README
          with open("README.md", "r", encoding="utf-8") as f:
              lines = f.readlines()

          # 4. Filter and Replace
          new_lines = []
          skip = False
          tag_found = False

          for line in lines:
              if start_tag in line:
                  new_lines.append(line)
                  new_lines.append(date_str + "\n") # Insert the new date & ligatures
                  skip = True
                  tag_found = True
              elif end_tag in line:
                  new_lines.append(line)
                  skip = False
              elif not skip:
                  new_lines.append(line)

          if not tag_found:
              print("Tags not found! Check your README.md markers.")
              sys.exit(1)

          # 5. Write back
          with open("README.md", "w", encoding="utf-8") as f:
              f.writelines(new_lines)
